# This is the worker site file for cida.usgs.gov

# Change this once we have shared web storage
DocumentRoot /opt/httpd/share/html

SSLProxyEngine ON
RewriteEngine ON
ProxyPreserveHost ON

SSLProxyEngine ON
RewriteEngine ON
ProxyPreserveHost ON

IndexOptions FancyIndexing

##
## /thredds (NONE) --dekester
##

RewriteRule ^/thredds$ /thredds/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/thredds/(.*)$ balancer://eros-thredds-prod/thredds/$1 [P,L]
RewriteRule ^/thredds/(.*)$ balancer://eros-thredds-prodssl/thredds/$1 [P,L]

<Location /thredds>
    ProxyPassReverse balancer://eros-thredds-prod/thredds
    ProxyPassReverse balancer://eros-thredds-prodssl/thredds
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    Header edit Location ^https://[^:]+:8444/thredds/ https://cida.usgs.gov/thredds/ env=!HTTPS
    Header edit Location ^http://[^:]+:8081/thredds/ http://cida.usgs.gov/thredds/ env=HTTPS
</Location>

##
## /gdp/geoserver (INFRA-942) --dekester
##

RewriteRule ^/gdp/geoserver$ /gdp/geoserver/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/gdp/geoserver/(.*)$ balancer://eros-gdpgeo-prod/geoserver/$1 [P,L]
RewriteRule ^/gdp/geoserver/(.*)$ balancer://eros-gdpgeo-prodssl/geoserver/$1 [P,L]

<Location /gdp/geoserver>
    ProxyPassReverse balancer://eros-gdpgeo-prod/geoserver
    ProxyPassReverse balancer://eros-gdpgeo-prodssl/geoserver
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    ProxyPassReverseCookiePath /geoserver /gdp/geoserver
    Header edit Location ^https://[^/]+/geoserver/ https://cida.usgs.gov/gdp/geoserver/ env=!HTTPS
    Header edit Location ^http://[^/]+/geoserver/ http://cida.usgs.gov/gdp/geoserver/ env=HTTPS
</Location>

##
## /gdp/geonetwork (INFRA-788) --dekester
##

RewriteRule ^/gdp/geonetwork$ /gdp/geonetwork/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/gdp/geonetwork/(.*)$ balancer://wiwsc-gdp-geonetwork-prod/geonetwork/$1 [P,L]
RewriteRule ^/gdp/geonetwork/(.*)$ balancer://wiwsc-gdp-geonetwork-prodssl/geonetwork/$1 [P,L]

<Location /gdp/geonetwork>
    ProxyPassReverse balancer://wiwsc-gdp-geonetwork-prod/geonetwork
    ProxyPassReverse balancer://wiwsc-gdp-geonetwork-prodssl/geonetwork
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    ProxyPassReverseCookiePath /geonetwork /gdp/geonetwork
    Header edit Location ^https://[^/]+/geonetwork/ https://cida.usgs.gov/gdp/geonetwork/ env=!HTTPS
    Header edit Location ^http://[^/]+/geonetwork/ http://cida.usgs.gov/gdp/geonetwork/ env=HTTPS
</Location>

##
## /gdp/process
##

RewriteRule ^/gdp/process$ /gdp/process/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/gdp/process/(.*)$ balancer://eros-gdp1-prod/gdp-process-wps/$1 [P,L]
RewriteRule ^/gdp/process/(.*)$ balancer://eros-gdp1-prodssl/gdp-process-wps/$1 [P,L]

<Location /gdp/process>
    ProxyPassReverse balancer://eros-gdp1-prod/gdp-process-wps
    ProxyPassReverse balancer://eros-gdp1-prodssl/gdp-process-wps
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    ProxyPassReverseCookiePath /gdp-process-wps /gdp/process
    Header edit Location ^https://[^:]+:8443/gdp-process-wps/ https://cida.usgs.gov/gdp/process/ env=!HTTPS
    Header edit Location ^http://[^:]+:8080/gdp-process-wps/ http://cida.usgs.gov/gdp/process/ env=HTTPS
</Location>

##
## /gdp/utility 
##

RewriteRule ^/gdp/utility$ /gdp/utility/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/gdp/utility/(.*)$ balancer://eros-gdp2-prod/gdp-utility-wps/$1 [P,L]
RewriteRule ^/gdp/utility/(.*)$ balancer://eros-gdp2-prodssl/gdp-utility-wps/$1 [P,L]

<Location /gdp/utility>
    ProxyPassReverse balancer://eros-gdp2-prod/gdp-utility-wps
    ProxyPassReverse balancer://eros-gdp2-prodssl/gdp-utility-wps
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    ProxyPassReverseCookiePath /gdp-utility-wps /gdp/utility
    Header edit Location ^https://[^:]+:8443/gdp-utility-wps/ https://cida.usgs.gov/gdp/utility/ env=!HTTPS
    Header edit Location ^http://[^:]+:8080/gdp-utility-wps/ http://cida.usgs.gov/gdp/utility/ env=HTTPS
</Location>

##
## /gdp
##

RewriteRule ^/gdp$ /gdp/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/gdp/(.*)$ balancer://eros-gdp2-prod/GDP_WEB/$1 [P,L]
RewriteRule ^/gdp/(.*)$ balancer://eros-gdp2-prodssl/GDP_WEB/$1 [P,L]

<Location /gdp>
    ProxyPassReverse balancer://eros-gdp2-prod/GDP_WEB
    ProxyPassReverse balancer://eros-gdp2-prodssl/GDP_WEB
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    ProxyPassReverseCookiePath /GDP_WEB /gdp
    Header edit Location ^https://[^:]+:8443/GDP_WEB/ https://cida.usgs.gov/gdp/ env=!HTTPS
    Header edit Location ^http://[^:]+:8080/GDP_WEB/ http://cida.usgs.gov/gdp/ env=HTTPS
</Location>

##
## /climate/gdp/process (INFRA-788) --dekester
##

RewriteRule ^/climate/gdp/process$ /climate/gdp/process/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/climate/gdp/process/(.*)$ balancer://eros-gdp1-prod/gdp-process-wps/$1 [P,L]
RewriteRule ^/climate/gdp/process/(.*)$ balancer://eros-gdp1-prodssl/gdp-process-wps/$1 [P,L]

<Location /climate/gdp/process>
    ProxyPassReverse balancer://eros-gdp1-prod/gdp-process-wps
    ProxyPassReverse balancer://eros-gdp1-prodssl/gdp-process-wps
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    ProxyPassReverseCookiePath /gdp-process-wps /climate/gdp/process
    Header edit Location ^https://[^/]+/gdp-process-wps/ https://cida.usgs.gov/climate/gdp/process/ env=!HTTPS
    Header edit Location ^http://[^/]+/gdp-process-wps/ http://cida.usgs.gov/climate/gdp/process/ env=HTTPS
</Location>

##
## /climate/gdp/utility (INFRA-788) --dekester
##

RewriteRule ^/climate/gdp/utility$ /climate/gdp/utility/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/climate/gdp/utility/(.*)$ balancer://eros-gdp2-prod/gdp-utility-wps/$1 [P,L]
RewriteRule ^/climate/gdp/utility/(.*)$ balancer://eros-gdp2-prodssl/gdp-utility-wps/$1 [P,L]

<Location /climate/gdp/utility>
    ProxyPassReverse balancer://eros-gdp2-prod/gdp-utility-wps
    ProxyPassReverse balancer://eros-gdp2-prodssl/gdp-utility-wps
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    ProxyPassReverseCookiePath /gdp-utility-wps /climate/gdp/utility
    Header edit Location ^https://[^/]+/gdp-utility-wps/ https://cida.usgs.gov/climate/gdp/utility/ env=!HTTPS
    Header edit Location ^http://[^/]+/gdp-utility-wps/ http://cida.usgs.gov/climate/gdp/utility/ env=HTTPS
</Location>

##
## /climate/gdp (INFRA-788) --dekester
##

RewriteRule ^/climate/gdp$ /climate/gdp/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/climate/gdp/(.*)$ balancer://eros-gdp-climate-prod/GDP_WEB/$1 [P,L]
RewriteRule ^/climate/gdp/(.*)$ balancer://eros-gdp-climate-prodssl/GDP_WEB/$1 [P,L]

<Location /climate/gdp>
    ProxyPassReverse balancer://eros-gdp-climate-prod/GDP_WEB
    ProxyPassReverse balancer://eros-gdp-climate-prodssl/GDP_WEB
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    ProxyPassReverseCookiePath /GDP_WEB /climate/gdp
    Header edit Location ^https://[^/]+/GDP_WEB/ https://cida.usgs.gov/climate/gdp/ env=!HTTPS
    Header edit Location ^http://[^/]+/GDP_WEB/ http://cida.usgs.gov/climate/gdp/ env=HTTPS
</Location>

##
## /climate (INFRA-788) --dekester
##

RewriteRule ^/climate$ /climate/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/climate/(.*)$ balancer://eros-gdp-climate-prod/CC_DOCS/$1 [P,L]
RewriteRule ^/climate/(.*)$ balancer://eros-gdp-climate-prodssl/CC_DOCS/$1 [P,L]

<Location /climate>
    ProxyPassReverse balancer://eros-gdp-climate-prod/CC_DOCS
    ProxyPassReverse balancer://eros-gdp-climate-prodssl/CC_DOCS
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    ProxyPassReverseCookiePath /CC_DOCS /climate
    Header edit Location ^https://[^/]+/CC_DOCS/ https://cida.usgs.gov/climate/ env=!HTTPS
    Header edit Location ^http://[^/]+/CC_DOCS/ http://cida.usgs.gov/climate/ env=HTTPS
</Location>

##
## /sparrow (INFRA-876) --dekester/sstephan
##

RewriteRule ^/sparrow$ /sparrow/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/sparrow/(.*)$ balancer://eros-sparrow1gui-prod/sparrow/$1 [P,L]
RewriteRule ^/sparrow/(.*)$ balancer://eros-sparrow1gui-prodssl/sparrow/$1 [P,L]

<Location /sparrow>
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    Header edit Location ^https://[^/]+/sparrow/ https://cida.usgs.gov/sparrow/ env=!HTTPS
    Header edit Location ^http://[^/]+/sparrow/ http://cida.usgs.gov/sparrow/ env=HTTPS
</Location>

##
## /sparrow_mv (INFRA-876) --dekester/sstephan
##

RewriteRule ^/sparrow_mv$ /sparrow_mv/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/sparrow_mv/(.*)$ balancer://eros-sparrow1svc-prod/sparrow_mv/$1 [P,L]
RewriteRule ^/sparrow_mv/(.*)$ balancer://eros-sparrow1svc-prod-ssl/sparrow_mv/$1 [P,L]

<Location /sparrow_mv>
    ProxyPassReverse balancer://eros-sparrow1svc-prod/sparrow_mv
    ProxyPassReverse balancer://eros-sparrow1svc-prodssl/sparrow_mv
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    Header edit Location ^https://[^/]+/sparrow_mv/ https://cida.usgs.gov/sparrow_mv/ env=!HTTPS
    Header edit Location ^http://[^/]+/sparrow_mv/ http://cida.usgs.gov/sparrow_mv/ env=HTTPS
</Location>

##
## /sparrow_mv_eros (INFRA-1212) --sstephan
##

RewriteRule ^/sparrow_mv_eros$ /sparrow_mv_eros/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/sparrow_mv_eros/(.*)$ balancer://eros-sparrow1svc-prod/sparrow_mv/$1 [P,L]
RewriteRule ^/sparrow_mv_eros/(.*)$ balancer://eros-sparrow1svc-prod-ssl/sparrow_mv/$1 [P,L]

<Location /sparrow_mv_eros>
    ProxyPassReverse balancer://eros-sparrow1svc-prod/sparrow_mv
    ProxyPassReverse balancer://eros-sparrow1svc-prodssl/sparrow_mv
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    Header edit Location ^https://[^/]+/sparrow_mv_eros/ https://cida.usgs.gov/sparrow_mv/ env=!HTTPS
    Header edit Location ^http://[^/]+/sparrow_mv_eros/ http://cida.usgs.gov/sparrow_mv/ env=HTTPS
</Location>

##
## /qa/nwc/nwcip (INFRA-1174) --sstephan
##

RewriteRule ^/qa/nwc/nwcip$ /qa/nwc/nwcip/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/qa/nwc/nwcip/(.*)$ balancer://watersmartqa/nwcip/$1 [P,L]
RewriteRule ^/qa/nwc/nwcip/(.*)$ balancer://watersmartqa-ssl/nwcip/$1 [P,L]

<Location /qa/nwc/nwcip>
    ProxyPassReverse balancer://watersmartqa/nwcip
    ProxyPassReverse balancer://watersmartqa-ssl/nwcip
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    ProxyPassReverseCookiePath /nwcip /qa/nwc/nwcip
    Header edit Location ^https://[^:]+:8443/nwcip/ https://cida.usgs.gov/qa/nwc/nwcip/ env=!HTTPS
    Header edit Location ^http://[^:]+:8080/nwcip/ http://cida.usgs.gov/qa/nwc/nwcip/ env=HTTPS
</Location>

##
## /qa/nwc/geoserver (INFRA-1174) --sstephan
##

RewriteRule ^/qa/nwc/geoserver$ /qa/nwc/geoserver/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/qa/nwc/geoserver/(.*)$ balancer://watersmartqa/qa/nwc/geoserver/$1 [P,L]
RewriteRule ^/qa/nwc/geoserver/(.*)$ balancer://watersmartqa-ssl/qa/nwc/geoserver/$1 [P,L]

<Location /qa/nwc/geoserver>
    ProxyPassReverse balancer://watersmartqa/qa/nwc/geoserver
    ProxyPassReverse balancer://watersmartqa-ssl/qa/nwc/geoserver
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    Header edit Location ^https://[^:]+:8443/qa/nwc/geoserver/ https://cida.usgs.gov/qa/nwc/geoserver/ env=!HTTPS
    Header edit Location ^http://[^:]+:8080/qa/nwc/geoserver/ http://cida.usgs.gov/qa/nwc/geoserver/ env=HTTPS
</Location>

##
## /qa/nwc/thredds (INFRA-1174) --sstephan
##

RewriteRule ^/qa/nwc/thredds$ /qa/nwc/thredds/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/qa/nwc/thredds/(.*)$ balancer://watersmartqa/qa/nwc/thredds/$1 [P,L]
RewriteRule ^/qa/nwc/thredds/(.*)$ balancer://watersmartqa-ssl/qa/nwc/thredds/$1 [P,L]

<Location /qa/nwc/thredds>
    ProxyPassReverse balancer://watersmartqa/qa/nwc/thredds
    ProxyPassReverse balancer://watersmartqa-ssl/qa/nwc/thredds
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    Header edit Location ^https://[^:]+:8443/qa/nwc/thredds/ https://cida.usgs.gov/qa/nwc/thredds/ env=!HTTPS
    Header edit Location ^http://[^:]+:8080/qa/nwc/thredds/ http://cida.usgs.gov/qa/nwc/thredds/ env=HTTPS
</Location>

##
## /qa/nwc/wps (INFRA-1174) --sstephan
##

RewriteRule ^/qa/nwc/wps$ /qa/nwc/wps/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/qa/nwc/wps/(.*)$ balancer://watersmartqa/wps/$1 [P,L]
RewriteRule ^/qa/nwc/wps/(.*)$ balancer://watersmartqa-ssl/wps/$1 [P,L]

<Location /qa/nwc/wps>
    ProxyPassReverse balancer://watersmartqa/wps
    ProxyPassReverse balancer://watersmartqa-ssl/wps
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    ProxyPassReverseCookiePath /wps /qa/nwc/wps
    Header edit Location ^https://[^:]+:8443/wps/ https://cida.usgs.gov/qa/nwc/wps/ env=!HTTPS
    Header edit Location ^http://[^:]+:8080/wps/ http://cida.usgs.gov/qa/nwc/wps/ env=HTTPS
</Location>

##
## /nwc/nwcip (INFRA-1174) --sstephan
##

RewriteRule ^/nwc/nwcip$ /nwc/nwcip/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/nwc/nwcip/(.*)$ balancer://watersmartprod/nwcip/$1 [P,L]
RewriteRule ^/nwc/nwcip/(.*)$ balancer://watersmartprod-ssl/nwcip/$1 [P,L]

<Location /nwc/nwcip>
    ProxyPassReverse balancer://watersmartprod/nwcip
    ProxyPassReverse balancer://watersmartprod-ssl/nwcip
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    ProxyPassReverseCookiePath /nwcip /nwc/nwcip
    Header edit Location ^https://[^:]+:8443/nwcip/ https://cida.usgs.gov/nwc/nwcip/ env=!HTTPS
    Header edit Location ^http://[^:]+:8080/nwcip/ http://cida.usgs.gov/nwc/nwcip/ env=HTTPS
</Location>

##
## /nwc/geoserver (INFRA-1174) --sstephan
##

RewriteRule ^/nwc/geoserver$ /nwc/geoserver/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/nwc/geoserver/(.*)$ balancer://watersmartprod/nwc/geoserver/$1 [P,L]
RewriteRule ^/nwc/geoserver/(.*)$ balancer://watersmartprod-ssl/nwc/geoserver/$1 [P,L]

<Location /nwc/geoserver>
    ProxyPassReverse balancer://watersmartprod/nwc/geoserver
    ProxyPassReverse balancer://watersmartprod-ssl/nwc/geoserver
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    Header edit Location ^https://[^:]+:8443/nwc/geoserver/ https://cida.usgs.gov/nwc/geoserver/ env=!HTTPS
    Header edit Location ^http://[^:]+:8080/nwc/geoserver/ http://cida.usgs.gov/nwc/geoserver/ env=HTTPS
</Location>

##
## /nwc/thredds (INFRA-1174) --sstephan
##

RewriteRule ^/nwc/thredds$ /nwc/thredds/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/nwc/thredds/(.*)$ balancer://watersmartprod/nwc/thredds/$1 [P,L]
RewriteRule ^/nwc/thredds/(.*)$ balancer://watersmartprod-ssl/nwc/thredds/$1 [P,L]

<Location /nwc/thredds>
    ProxyPassReverse balancer://watersmartprod/nwc/thredds
    ProxyPassReverse balancer://watersmartprod-ssl/nwc/thredds
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    Header edit Location ^https://[^:]+:8443/nwc/thredds/ https://cida.usgs.gov/nwc/thredds/ env=!HTTPS
    Header edit Location ^http://[^:]+:8080/nwc/thredds/ http://cida.usgs.gov/nwc/thredds/ env=HTTPS
</Location>


##
## /nwc/wps (INFRA-1174) --sstephan
##

RewriteRule ^/nwc/wps$ /nwc/wps/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/nwc/wps/(.*)$ balancer://watersmartprod/wps/$1 [P,L]
RewriteRule ^/nwc/wps/(.*)$ balancer://watersmartprod-ssl/wps/$1 [P,L]

<Location /nwc/wps>
    ProxyPassReverse balancer://watersmartprod/wps
    ProxyPassReverse balancer://watersmartprod-ssl/wps
    ProxyPassReverseCookieDomain .usgs.gov cida.usgs.gov
    ProxyPassReverseCookiePath /wps /nwc/wps
    Header edit Location ^https://[^:]+:8443/wps/ https://cida.usgs.gov/nwc/wps/ env=!HTTPS
    Header edit Location ^http://[^:]+:8080/wps/ http://cida.usgs.gov/nwc/wps/ env=HTTPS
</Location>

# vim: syntax=apache tw=200 expandtab tabstop=4 softtabstop=4 showmatch nocompatible shiftwidth=4 ai
