# This is the worker site file for internal.cida.usgs.gov

SSLProxyEngine ON
RewriteEngine ON
ProxyPreserveHost ON

IndexOptions FancyIndexing

##
## /i (NONE) --dekester
##

RewriteRule ^/i$ /i/ [R=301,L]
RewriteCond %{HTTPS} off
RewriteRule ^/i/(.*)$ balancer://apex-i/i/$1 [P,L]
RewriteRule ^/i/(.*)$ balancer://apex-i-ssl/i/$1 [P,L]

<Location /i>
    ProxyPassReverse balancer://apex-i/i
    ProxyPassReverse balancer://apex-i-ssl/i
    ProxyPassReverseCookieDomain .usgs.gov internal.cida.usgs.gov
    Header edit Location ^https://[^:]+:8443/i/ https://internal.cida.usgs.gov/i/ env=!HTTPS
    Header edit Location ^http://[^:]+:8080/i/ http://internal.cida.usgs.gov/i/ env=HTTPS
</Location>

# vim: syntax=apache tw=200 expandtab tabstop=4 softtabstop=4 showmatch nocompatible shiftwidth=4 ai
